Widget.types['news_detail'] = {
	initialize: function() {
		var _this = this;
		
		//called before this._element is available
		this._element = Widget.parseHTML(this._instanceInformation.content);
		this._element.append(Widget.parseHTML("{{includeTemplate=content}}"));
		Widget.callStatic('detail', 'create_for_instance', this);

		this._element.find("select[name='news_type_id']").prepareWidget(function(news_type_input_widget) {
			news_type_input_widget.settings.initial_selection = _this.settings.initial_type_id;
			news_type_input_widget.settings.disabled = !!_this.settings.predefined_news_type_id;
		}, function(news_type_input_widget) {
			if(_this.settings.predefined_news_type_id) {
				news_type_input_widget.val(_this.settings.predefined_news_type_id);
			}
		});

		var school_class_select = this._element.find("select[name='school_class_id']");
		school_class_select.prepareWidget(function(classes_input_widget) {
			jQuery(school_class_select).val(_this.settings.predefined_school_class_id);
			classes_input_widget.settings.disabled = !!_this.settings.predefined_school_class_id;
		}, function(classes_input_widget) {
			if(_this.settings.predefined_school_class_id) {
				classes_input_widget._element.val(_this.settings.predefined_school_class_id);
				_this._element.find('.service_select_items').hide();
			}
		});

	},

	prepare: function() {
		//called when this._element is available

	},

	fill_data: function() {
		this.loadData(function(data) {
			console.log(data);
			this._element.find('input[name="id"]').val(data.Id);
			this._element.find('input[name="news_type_id"]').val(data.NewsTypeId);
			this._element.find('input[name="headline"]').val(data.Headline);
			this._element.find('textarea[name="body"]').text(data.Body);
			this._element.find('input[name="body_short"]').val(data.BodyShort);
			this._element.find('input[name="date_start"]').val(data.DateStart);
			this._element.find('input[name="date_end"]').val(data.DateEnd);
			this._element.find('input[name="is_inactive"]').val(data.IsInactive);
			this._element.find('input[name="school_class_id"]').val(data.SchoolClassId);
			this._element.find('input[name="image_id"]').val(data.ImageId);
			this._element.find('input[name="created_at"]').val(data.CreatedAt);
			this._element.find('input[name="created_by"]').val(data.CreatedBy);
			this._element.find('input[name="updated_at"]').val(data.UpdatedAt);
			this._element.find('input[name="updated_by"]').val(data.UpdatedBy);
		});
	},

	settings: {"detail_widget":{}}
};